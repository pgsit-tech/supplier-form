# ğŸ”§ KV æ•°æ®æ›´æ–°æŒ‡å—

## ğŸ“‹ å½“å‰çŠ¶æ€æ£€æŸ¥

æ ¹æ®æ‚¨çš„æˆªå›¾ï¼Œæˆ‘å‘ç°ä»¥ä¸‹é—®é¢˜éœ€è¦ä¿®æ­£ï¼š

### âŒ é—®é¢˜ 1: ç®¡ç†å‘˜å¯†ç å“ˆå¸Œä¸åŒ¹é…
- **å½“å‰ KV ä¸­çš„å“ˆå¸Œ**: `a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3`
- **Worker æœŸæœ›çš„å“ˆå¸Œ**: `43fa4a393b6f4d046d4010740b4078a50e04197c6c08d8fa5575493bcd127c45`
- **åŸå› **: KV ä¸­çš„å“ˆå¸Œä¸ Worker ä»£ç çš„å“ˆå¸Œç®—æ³•ä¸åŒ¹é…

### âŒ é—®é¢˜ 2: ç¯å¢ƒå˜é‡éœ€è¦æ›´æ–°
- **å½“å‰**: åªæ”¯æŒå•ä¸ªå‰ç«¯åŸŸå
- **éœ€è¦**: æ”¯æŒå¤šä¸ªå‰ç«¯åŸŸå

## ğŸ”§ ä¿®æ­£æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šæ›´æ–°ç®¡ç†å‘˜è´¦æˆ·æ•°æ®

åœ¨ Cloudflare Dashboard â†’ KV â†’ admin-users ä¸­ï¼š

#### 1. æ›´æ–° `user:admin` é”®çš„å€¼
```json
{
  "id": "admin_001",
  "username": "admin",
  "passwordHash": "43fa4a393b6f4d046d4010740b4078a50e04197c6c08d8fa5575493bcd127c45",
  "name": "PGSç³»ç»Ÿç®¡ç†å‘˜",
  "role": "admin",
  "email": "admin@pgs.com",
  "createdAt": "2025-06-11T04:29:26.072Z",
  "isActive": true
}
```

#### 2. æ·»åŠ  `user:pgs-admin` é”®ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
```json
{
  "id": "admin_002",
  "username": "pgs-admin",
  "passwordHash": "43fa4a393b6f4d046d4010740b4078a50e04197c6c08d8fa5575493bcd127c45",
  "name": "PGSå¤‡ç”¨ç®¡ç†å‘˜",
  "role": "admin",
  "email": "pgs-admin@pgs.com",
  "createdAt": "2025-06-11T04:29:26.074Z",
  "isActive": true
}
```

**æ–°å¯†ç **: `hello123` ï¼ˆæ»¡è¶³6ä¸ªå­—ç¬¦æœ€ä½è¦æ±‚ï¼‰

### ç¬¬äºŒæ­¥ï¼šæ›´æ–°ç¯å¢ƒå˜é‡

åœ¨ Cloudflare Dashboard â†’ Workers â†’ supplier-form-api â†’ è®¾ç½® â†’ å˜é‡å’Œæœºå¯†ä¸­ï¼š

#### æ›´æ–° `FRONTEND_URL` å˜é‡
**å½“å‰å€¼**: `https://supplier-form.pages.dev`
**æ–°å€¼**: `https://supplier-form.pages.dev,https://spcode.pgs-log.cn`

è¿™æ ·å¯ä»¥æ”¯æŒä¸¤ä¸ªå‰ç«¯åŸŸåçš„ CORS è®¿é—®ã€‚

### ç¬¬ä¸‰æ­¥ï¼šéªŒè¯ KV æ•°æ®ç»“æ„

ç¡®ä¿ `supplier-applications` KV ä¸­æœ‰ä»¥ä¸‹é”®ï¼š

#### ç»Ÿè®¡æ•°æ®é”®
- **é”®**: `applications:stats`
- **å€¼**: `{"total":0,"pending":0,"approved":0,"rejected":0}`

#### ç´¢å¼•é”®
- **é”®**: `applications:list`
- **å€¼**: `[]`

- **é”®**: `applications:by_status:pending`
- **å€¼**: `[]`

- **é”®**: `applications:by_status:approved`
- **å€¼**: `[]`

- **é”®**: `applications:by_status:rejected`
- **å€¼**: `[]`

## ğŸ§ª éªŒè¯æ­¥éª¤

### 1. æµ‹è¯•ç®¡ç†å‘˜ç™»å½•
å®Œæˆä¸Šè¿°æ›´æ–°åï¼Œä½¿ç”¨ä»¥ä¸‹å‡­æ®æµ‹è¯•ç™»å½•ï¼š
- **ç”¨æˆ·å**: `admin`
- **å¯†ç **: `hello123`

### 2. æµ‹è¯• API ç«¯ç‚¹
- å¥åº·æ£€æŸ¥: `GET /api/health`
- ç®¡ç†å‘˜ç™»å½•: `POST /api/admin/login`

### 3. æµ‹è¯• CORS
ç¡®ä¿å‰ç«¯å¯ä»¥ä»ä¸¤ä¸ªåŸŸåè®¿é—® APIï¼š
- `https://supplier-form.pages.dev`
- `https://spcode.pgs-log.cn`

## ğŸ“ æ“ä½œæ¸…å•

- [ ] æ›´æ–° `admin-users` KV ä¸­çš„ `user:admin` æ•°æ®
- [ ] æ·»åŠ  `admin-users` KV ä¸­çš„ `user:pgs-admin` æ•°æ®
- [ ] æ›´æ–° Worker ç¯å¢ƒå˜é‡ `FRONTEND_URL`
- [ ] éªŒè¯ `supplier-applications` KV ä¸­çš„ç´¢å¼•æ•°æ®
- [ ] æµ‹è¯•ç®¡ç†å‘˜ç™»å½•åŠŸèƒ½
- [ ] æµ‹è¯• CORS é…ç½®

## ğŸ” æ•…éšœæ’é™¤

### å¦‚æœç™»å½•ä»ç„¶å¤±è´¥
1. æ£€æŸ¥å¯†ç å“ˆå¸Œæ˜¯å¦å®Œå…¨åŒ¹é…
2. ç¡®è®¤ç”¨æˆ·åæ‹¼å†™æ­£ç¡®
3. æŸ¥çœ‹ Worker æ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯

### å¦‚æœ CORS é”™è¯¯
1. ç¡®è®¤ `FRONTEND_URL` åŒ…å«æ­£ç¡®çš„åŸŸå
2. æ£€æŸ¥åŸŸåæ ¼å¼ï¼ˆåŒ…å« https://ï¼‰
3. é‡æ–°éƒ¨ç½² Worker ä»£ç 

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ï¼š
1. å…·ä½“çš„é”™è¯¯ä¿¡æ¯
2. æµè§ˆå™¨æ§åˆ¶å°æ—¥å¿—
3. Worker æ—¥å¿—æˆªå›¾
4. KV æ•°æ®æˆªå›¾